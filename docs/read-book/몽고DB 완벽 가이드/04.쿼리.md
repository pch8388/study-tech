# find
- 쿼리에 사용
  - 쿼리는 도큐먼트의 서브셋을 반환(빈 컨렉션부터 컬렉션 전체까지)
- 빈 쿼리 도큐먼트({})는 컬렉션 내 모든 것과 일치
  - 매개변수에 쿼리 도큐먼트가 없으면 빈 쿼리 도큐먼트로 인식
```javascript
> db.c.find()
```
- 쿼리 도큐먼트에 여러 개의 키/값 쌍을 추가하면 `조건1 and 조건2 and ... 조건N`과 같은 형태로 조회한다
```javascript
// username = joe and age = 27
> db.users.find({"username":"joe", "age":27})
```

## 반환받을 키 지정
- 두 번째 매개변수에 원하는 키를 지정
- value 에 `1 = 포함` , `0 = 미포함`
```javascript
// username 은 결과에 포함, _id 는 결과에 포함하지 않음
> db.users.find({}, {"username":1, "_id":0})
```

## 제약 사항
데이터베이스에서 쿼리 도큐먼트 값은 반드시 상수여야 함

# 쿼리 조건
완전 일치, 범위, OR, 부정 조건 등으로 쿼리가 가능함

### 쿼리 조건절
|쿼리 기호|수학 기호|
|--|--|
|$lt|<|
|$lte|<=|
|$gt|>|
|$gte|>=|
|$ne|!=|

- 날짜는 밀리초 단위로 저장되므로 일치 조건은 유용성이 떨어짐
- `$ne`는 모든 데이터형에 사용 가능

### OR 쿼리
`$in` : 하나의 키를 다양한 값과 비교
```javascript
> db.raffle.find({"ticket_no" : {$in: [725, 542, 390]}})
// 서로 다른 데이터형도 사용 가능
> db.raffle.find({"user_id" : {$in: ["test", 1234]}})
```
`$nin` : not in 의 의미
```javascript
// 725, 542, 390 이 포함되지 않은 도큐먼트 반환
> db.raffle.find({"ticket_no" : {$nin: [725, 542, 390]}})
```
`$or` : 여러 키를 주어진 값과 비교
```javascript
// ticket_no 가 725 이거나 winner 가 true 인 도큐먼트 반환
> db.raffle.find({$or : [{"ticket_no" : 725}, {"winner": true}]})
```

> 일반적인 AND 쿼리에서는 최소한의 인수로 최적의 결과(범위를 좁힌 결과)를 추려내야 하고, OR 는 첫 번째 인수가 일치하는 도큐먼트가 많을 수록 효율적이다 => short-circuit(단축평가) 생각해보면 됨

> 옵티마이저는 `$or` 보다 `$in`을 더 효율적으로 다룬다

### $not
메타 조건절(metaconditional)이며 어떤 조건에도 적용 가능
```javascript
// $mod => 1번째 파라미터로 나눈 결과가 2번째 파라미터인 값을 찾음
// not 연산으로 결국에는 5로 mod 연산한 결과가 1인 값을 제외한 도큐먼트를 찾음
> db.users.find({"id_num": {$not: {$mod: [5, 1]}}})
```
정규 표현식과 함께 자주 사용
